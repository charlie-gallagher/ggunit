---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# ggunit

<!-- badges: start -->
[![Lifecycle: experimental](https://img.shields.io/badge/lifecycle-experimental-orange.svg)](https://lifecycle.r-lib.org/articles/stages.html#experimental)
[![CRAN status](https://www.r-pkg.org/badges/version/ggunit)](https://CRAN.R-project.org/package=ggunit)
<!-- badges: end -->

The goal of ggunit is to provide a consistent experience with `ggplot2` sizes,
proportions, and units. The package is for now simple, but with a 
powerful philosophy that makes it easy to choose proportions and scaling for 
your graphic. 

## Installation

ggunit is not available on CRAN. You can install the development version of ggunit from GitHub:

``` r
# install.packages("remotes")
remotes::install_github("charlie-gallagher/ggunit")
```

## Philosophy
The central philosophy of the ggunit package is that the unit "lines" is the
best design unit for data visualization proportions. One _line_ is the
height of a line of body text, for example the axis text. Since a primary goal
of visualizations is to have readable text, lines are a natural unit of
measurement. 

## Usage
The function `device_dimensions()` takes a height in lines of text, an aspect
ratio, and the body text size (in points) and generates the correct units (in
inches, by default) for height and width. 

```{r example}
library(ggunit)

dims <- device_dimensions(default_text = 11, 
                          height = 30, 
                          aspect_ratio = 16/9)

dims
```

The result is a list of length 2 with the requested dimensions. 

You can use the shortcut `ggunit_save()`, which is a thin wrapper around
`ggplot2::ggsave()`, to quickly iterate on graphic proportions. 

```r
library(ggplot2)
library(ggunit)

my_plot <- ggplot(mtcars, aes(x = disp, y = mpg)) + 
  geom_point() + 
  theme_linedraw(base_size = 11)
  
ggunit_save(
  plot = my_plot,
  filename = "~/Desktop/my_plot.png",
  dpi = 200,
  # Height in lines
  height = 30,
  aspect_ratio = 16/9
)
```


For designs that are constrained by physical dimensions, ggunit provides a way
to find the appropriate text size in points given physical dimensions and a 
desired proportion in lines, through `text_dimensions()`.

```{r}
text_dimensions(
    height = 5.5,
    units = "in",
    lines = 30
)
```

The text size is rounded to the nearest point by default. You can turn this off
by setting the `round` argument to `FALSE`. 

```{r}
text_dimensions(
    height = 5.5,
    units = "in",
    lines = 30,
    round = FALSE
)
```



### Other tools
Aligning text sizes in ggplot can be painful. The two main places you see text
sizes are in `geom_text()` for plotting text and `element_text()` for adjusting
theme elements. 

The problem is that `geom_text` uses millimeters for the `size` argument, and 
`element_text` uses points. The ggplot2 package provides the `.pt` constant, 
which is the number of points in 1 mm. 

ggunit generalizes this with the `mm()` function, which converts from (almost)
any unit available with `grid::unit()` to millimeters. The default is "pt" since
this is the main use case.

```{r}
default_text <- 11               # Text size in points

default_text / ggplot2::.pt      # Converted to millimeters
mm(default_text, "pt")           # Same, but more intuitive
```



---

Charlie Gallagher, March 2022
